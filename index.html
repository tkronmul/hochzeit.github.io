<!DOCTYPE html>
<html lang="de">
<head> 
  <meta charset="UTF-8">
  <title>Meine Website</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
  
<body>
  <div id="intro">
    <div id="Hello">
      <h1 style="text-align: center;">Willkommen auf der Website zu unserer Hochzeit!</h1>
    </div>
    <!--Passworteingabe -->
    <div id="Anmeldung">
      <h2 style="text-align: center;"> Bitte Passwort eingeben:</h2>
      <div style="display:flex; justify-content:center; align-items:center; gap:8px;">
        <input 
          type="password" 
          id="passwordInput" 
          placeholder="Passwort"
          style="width: 250px;"
          >
        <button id="checkBtn">Bestätigen</button>
      </div>
      <div id="result"></div>
    </div>
  </div>

  <!-- Menu -->
  <div id="topMenuBar" class="hidden">
    <div class="menu-wrapper">
      <button class="menuTab hidden" data-menu="hf">Hochzeitsfeier</button>

      <div id="submenu-hf" class="submenu hidden">
        <div data-target="kap1">Zeitstrahl</div>
        <div data-target="kap2">Informationen</div>
        <div data-target="kap3">Anmeldung</div>
      </div>
    </div>

    <div class="menu-wrapper">
      <button class="menuTab hidden" data-menu="pa">Polterabend</button>
      <div id="submenu-pa" class="submenu hidden">
          <div data-target="kap10">Zeitstrahl</div>
          <div data-target="kap11">Informationen</div>
          <div data-target="kap12">Anmeldung</div>
      </div>
    </div>
    <div class="menu-wrapper">
      <button class="menuTab hidden" data-menu="kon">Kontaktinformationen</button>
      <div id="submenu-kontakt" class="submenu hidden">
          <div data-target="kap13">Kontaktdaten</div>
      </div>
  </div>
  </div>
  

  
  <!-- Bereiche -->
  <section id="kap1" class="hidden">
    <h2 style="text-align:center;">Zeitstrahl Hochzeit </h2>
    <div class = "timeline">
      <div class="arrow"></div>
      <div class="event left">
        <h3>Check-in</h3>
        <div class="meta">
          ab 14:00 Uhr<br>
          Hotel Horneck<br>
          Selbstständiger Check-in im Hotel
        </div>
      </div>
      <div class="event right">
        <h3>Treffpunkt Freie Trauung</h3>
        <div class="meta">
          15:00 Uhr<br>
          Schlossgraben <br>
          Treppe vor Brücke nach unten
        </div>
      </div>
      <div class="event left">
        <h3>Freie Trauung</h3>
        <div class="meta">
          15:30 Uhr<br>
          Schlossgraben
        </div>
      </div>
      <div class="event right">
        <h3>Gruppenfoto</h3>
        <div class="meta">
          16:15 Uhr<br>
          Schlossgraben
        </div>
      </div>
      <div class="event left">
        <h3>Sektempfang</h3>
        <div class="meta">
          16:30 Uhr<br>
          Schlossterasse<br>
          Parallele Fotos <br>
          mit dem Hochzeitspaar
        </div>
      </div>
      <div class="event right">
        <h3>Abendessen</h3>
        <div class="meta">
          18:00 Uhr<br>
          Festsaal
        </div>
      </div>
      <div class="event left">
        <h3>Feier</h3>
        <div class="meta">
          21 Uhr<br>
          Jugenstilsaal<br>
        </div>
      </div>
      <div class="event right">
        <h3>Abendessen</h3>
        <div class="meta">
          02:00 Uhr<br>
          Ende der Feier
        </div>
      </div>
      <div class="event left">
        <h3>Gemeinsames Katerfrühstück</h3>
        <div class="meta">
          10 Uhr<br>
          Frühstückssaal<br>
        </div>
      </div>
  </section>
  
  <section id="kap2" class="hidden">Informationen Hochzeit 
  <div class="zweispaltig">
      <div class = "links">
        <ul>
          <li><strong>Location:</strong>
            <ul>
              Schlosshotel Horneck <br>
              Schloss Horneck 1 <br>
              74831 Gundelsheim <br>
              <a href="https://schlosshotel-horneck.de/" target="_blank"> </a>
            </ul>
          </li>
          <li><strong>Parkplätze:</strong>
            <ul> vorhanden (siehe rechts) </ul>
          </li>
          <li><strong>Dresscode:</strong>
            <li> Herren: Anzug oder Smoking </li>
            <li> Frauen: Kleid oder Anzug </li>
          </li>
          <li><strong>Kontaktdaten</strong>
            <ul>
            <li> Max Mustermann</li>
            <li> Stefanie Super</li>
          </li>
          <li><strong>Übernachtungen:</strong>
            <ul>
            <li> Über Anmeldemaske im Schlosshotel Horneck möglich</li>
            <li> Hotel zum Lamm Gundelsheim: <a href="https://www.lamm-gundelsheim.de/" target="_blank"> </a></li>
            <li> Hotel Garni: <a href="https://schell-schokoladen.de/hotel/" target="_blank"> </a></li>
          </li>
        </ul>
        <div class="rechts">
        <img src="images/Horneck.png" alt ="Zeitstrahl Horneck">
      </div>
      </div>
  </section>
  
  <section id="kap3" class="hidden">
    Anmeldung <br>
    <button id="openHochzeitBtn" class="event-btn">Anmeldung Hochzeitsfeier</button>
  </section>
  <section id="kap10" class="hidden"> Zeitstrahl Polterabend </section>
  <section id="kap11" class="hidden">
    <div class="zweispaltig">
      <div class = "links">
        <ul>
          <li><strong>Location:</strong>
            <ul>
              Ziegelberg 40 <br>
              74538 Rosengarten Rieden <br>
            </ul>
          </li>
          <li><strong>Parkplätze:</strong>
            <ul> vorhanden (siehe rechts) </ul>
          </li>
          <li><strong>Dresscode:</strong>
            <ul> wie ihr wollt </ul>
          </li>
          <li><strong>Kontaktdaten</strong>
            <ul>
            <li> Max Mustermann</li>
            <li> Stefanie Super</li>
          </li>
          <li><strong>Übernachtungen:</strong>
            <ul>
            <li> Zelten (siehe rechts)</li>
            <li> Hotel Hohenlohe: LINK</li>
            <li> Hotel XX: LINK</li>
          </li>
        </ul>
      </div>
      <div class="rechts">
        <img src="images/Rieden.png" alt ="Zeitstrahl Bild">
      </div>
    </div>
  </section>
  <section id="kap12" class="hidden">
    Anmeldung <br>
    <button id="openPolterabendBtn" class="hidden">Anmeldung Polterabend</button>
  </section>
  <section id="kap13" class="hidden"> Kontaktdaten </section>

  <!-- Formular Polterabend -->
  

  <div class = "overlay" id="overlay">
  <div id="popupPolterabend" class="popup">
    <button class="closeBtn" id="closeformPolBtn">&times;</butfstylton>
    <h2>Anmeldung Polterabend</h3>
    <form id="formPolterabend">
      <label>Vorname: <input type="text" id="vornamePol" name="vornamePol" required></label><br><br>
      <label>Nachname: <input type="text" id="nachnamePol" name="nachnamePol" required></label><br><br>
      <label><input type="checkbox" id="teilnahmePol" required> Ich nehme teil</label><br>
      <div id="TeilnahmePol" class="hidden">
        <label>Deine Ernährungsform und/oder Unverträglichkeiten: <input type="text" id="gewohnheitPol" name="gewohnheitPol"></label><br><br>
        <label><input type="checkbox" id="begleitungPol"> Ich komme mit Begleitung</label><br>
        <div id="BegleiterPol" class="hidden">
          <label>Anzahl Begleitpersonen:
            <input type="number" id="anzahlBegleiterPol" min="1" value="1"><br>
          </label>
          <div id="begleiterFelder"></div>
        </div>
        <label>Übernachtung:</label><br>
        <label><input type="radio" name="UebernachtungPol" value="Location"> Zelten</label>
        <label><input type="radio" name="UebernachtungPol" value="SelbstorgHoch"> Ich kümmere mich selbst darum / fahre nach Hause</label> <br>
        <label><input type="checkbox" id="mitbringen"> Ich bringe etwas für das Buffet mit</label><br>
        <div id="MitbringenSection" class="hidden">
          <label>Auswahl:</label><br>
          <label><input type="checkbox" name="Buffet" value="Kartoffelsalat"> Kartoffelsalat </label>
          <label><input type="checkbox" name="Buffet" value="Tomate-Mozzarella"> Tomate-Mazzarerlla </label><br>
          <label><input type="checkbox" name="Buffet" value="Nudelsalat"> Nudelsalat </label>
          <label><input type="checkbox" name="Buffet" value="Krautsalat"> Krautsalat </label><br>
          <label><input type="checkbox" name="Buffet" value="Grüner Salat"> Grüner Salat </label>
          <label><input type="checkbox" name="Buffet" value="Gurkensalat"> Gurkensalat </label><br>
          <label><input type="checkbox" name="Buffet" value="Pizzaschnecken"> Pzzaschnecken </label>
          <label><input type="checkbox" name="Buffet" value="Tzatziki"> Tzatziki </label><br>
          <label><input type="checkbox" name="Buffet" value="Hummus"> Hummus </label>
          <label><input type="checkbox" name="Buffet" value="Trauben-Käse-Spieße"> Trauben-Käse-Spieße </label><br>
          <label><input type="checkbox" name="Buffet" value="Gemüse mit Dip"> Gemüse mit Dip </label>
          <label><input type="checkbox" name="Buffet" value="Muffins"> Muffins </label><br>
          <label><input type="checkbox" name="Buffet" value="Brownies"> Brownies </label><br>
          <label>Weiteres: <input type="text" id="Weiteres" name="Weiteres" ></label><br>
        </div> 
        <label>Kommentar: <textarea id="kommentarPol" name="kommentar"></textarea></label><br>
      </div>
      <button type="submit">Absenden</button>
    </form>
  </div>
  </div>
  
  <div class="overlay" id="overlayHoch">
  <div id="popupHochzeit" class="popup">
    <button class="closeBtn" id="closeformHochBtn">&times;</button>
    <h2>Anmeldung Hochzeit</h3>
    <form id="formHochzeit">
      <label>Vorname: <input type="text" id="vornameHoch" name="vornameHoch" required></label><br><br>
      <label>Nachname: <input type="text" id="nachnameHoch" name="nachnameHoch" required></label><br><br>
      <label><input type="checkbox" id="teilnahmeHoch" required> Ich nehme teil</label><br>
      <div id="InformationenHoch" class="hidden">
        <label>Deine Ernährungsform und/oder Unverträglichkeiten: <input type="text" id="gewohnheitHoch" name="gewohnheitHoch"></label><br><br>
        <label><input type="checkbox" id="begleitungHoch"> Ich komme mit Begleitung</label><br>
        <div id="BegleiterHoch" class="hidden">
          <label>Anzahl Begleitpersonen:
            <input type="number" id="anzahlBegleiterHoch" min="1" value="1"><br>
          </label>
          <div id="begleiterFelderHoch"></div>
        </div>
        <label>Übernachtung:</label><br>
        <label><input type="radio" name="UebernachtungHoch" value="Location"> Ich möchte in der Location übernachten </label>
        <div id="Zimmer" class="hidden"> 
          <label>Anzahl Zimmer: <input type="number" id="anzahlZimmer" min="1" value="1"><br> </label>
        </div>
        <label><input type="radio" name="UebernachtungHoch" value="SelbstorgHoch"> Ich kümmere mich selbst darum / fahre nach Hause</label> <br>
        <label>Kommentar: <textarea id="kommentarHoch" name="kommentar"></textarea></label><br>
      </div>
      <button type="submit">Absenden</button>
    </form>
  </div>
  </div>

  <div id="notification" class="notification"> Erfolgreich abgesendet!</div>
  

  
  <script>
    //Passworteingabe
    const correctPassword1 = "78fd437096cd5bf68409698730d67ce7a588dfc26c325b3a2d7cdd9e35bd50b8";
    const correctPassword2 = "0f19c406623e70f5d55cbf72a5636ca4c0538db997e4edbe22d0b27c70afa591";
    const correctPassword3 = "936a185caaa266bb9cbe981e9e05cb78cd732b0b3280eb944412bb6f8f8f07af";

    const topMenu = document.getElementById("topMenuBar");
    const tabHoch = document.querySelector('.menuTab[data-menu="hf"]');
    const tabPol = document.querySelector('.menuTab[data-menu="pa"]');
    const tabKon = document.querySelector('.menuTab[data-menu="kon"]');
    const submenuHoch = document.getElementById("submenu-hf");
    const submenuPol = document.getElementById("submenu-pa");
    const submenuKontakt = document.getElementById("submenu-kontakt");

    async function sha256(message) {
      const msgBuffer = new TextEncoder().encode(message);
      const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
    } 
    async function checkPassword() {
      const input = document.getElementById("passwordInput").value;
      const intro = document.getElementById("intro");
      const Hello = document.getElementById("Hello");
      const Anmeldung = document.getElementById("Anmeldung");
      const resultDiv = document.getElementById("result");
      const openFormBtn = document.getElementById("openFormBtn");
      const HochzeitButton = document.getElementById("openHochzeitBtn");
      const output = document.getElementById("output");
      const openPolterabendBtn = document.getElementById("openPolterabendBtn");          
      const inputHash = await sha256(input);
      

      //Subseiten aufbauen je nach Passwort
      if (inputHash !== correctPassword1 && inputHash !== correctPassword2 && inputHash !== correctPassword3) {
        resultDiv.innerHTML = "<p class='error';'>Falsches Passwort </p>";
        return;
      }
      //Eines der Passwörter ist korrekt
      topMenu.classList.remove("hidden");
      Anmeldung.style.display = "none";
      
      if (inputHash === correctPassword1){
        resultDiv.innerHTML = "<p class='success'> Passwort 1 korrekt </p>";
        tabHoch.classList.remove("hidden");
        tabPol.classList.add("hidden");
        tabKon.classList.remove("hidden");
        submenuPol.classList.add("hidden"); 
        kap1.classList.remove("hidden");
        kap2.classList.remove("hidden"); 
        kap3.classList.remove("hidden");
        kap13.classList.remove("hidden");
        document.getElementById("intro").style.display="none";
      } else if (inputHash === correctPassword2) {
        resultDiv.innerHTML = "<p class='success'> Passwort 2 korrekt </p>";
        formPolterabend.style.display = "inline-block";
        tabHoch.classList.remove("hidden");
        tabPol.classList.remove("hidden");
        tabKon.classList.remove("hidden");
        openPolterabendBtn.classList.remove("hidden");
        kap1.classList.remove("hidden");
        kap2.classList.remove("hidden");
        kap3.classList.remove("hidden");
        kap10.classList.remove("hidden");
        kap11.classList.remove("hidden");
        kap12.classList.remove("hidden");
        kap13.classList.remove("hidden");
        document.getElementById("intro").style.display="none";
      } else if(inputHash === correctPassword3) {
        resultDiv.innerHTML = "<p class='success'> Passwort 3 korrekt </p>";
        formPolterabend.style.display ="inline-block";
        tabPol.classList.remove("hidden");
        tabHoch.classList.add("hidden");
        tabKon.classList.remove("hidden");
        submenuHoch.classList.add("hidden"); 
        kap10.classList.remove("hidden");
        kap11.classList.remove("hidden");
        kap12.classList.remove("hidden");
        kap13.classList.remove("hidden");
        document.getElementById("intro").style.display="none";
      }
      //Menüband
      const tabs = document.querySelectorAll(".menuTab:not(.hidden)");
      tabs.forEach(tab => {
        tab.addEventListener("click", () => {
            const menu = tab.dataset.menu;
    
            // Anzeigen oder ausblenden
            if (menu === "hf") {
                submenuHoch.classList.toggle("hidden");
                submenuKontakt.classList.add("hidden");
                submenuPol.classList.add("hidden");
            }
            if (menu === "pa") {
                submenuPol.classList.toggle("hidden");
                submenuKontakt.classList.add("hidden");
                submenuHoch.classList.add("hidden");
            }
          if (menu === "kon") {
                submenuPol.classList.add("hidden");
                submenuKontakt.classList.toggle("hidden");
                submenuHoch.classList.add("hidden");
            }
          });
      });
    }
      //Button + Enter
      document.getElementById("checkBtn").addEventListener("click", checkPassword);
      document.getElementById("passwordInput").addEventListener("keypress", function(event) {
        if (event.key === "Enter") checkPassword();
      });
       

    // Submenu-Einträge → Scroll & Menüs schließen
    document.querySelectorAll(".submenu div").forEach(item => {
        item.addEventListener("click", () => {
            const targetId = item.dataset.target;
            const target = document.getElementById(targetId);

            if (target) {
                target.scrollIntoView({ behavior: "smooth", block: "start" });
            }

            submenuHoch.classList.add("hidden");
            submenuPol.classList.add("hidden");
            submenuKontakt.classList.add("hidden");
        });
    });

    //Zeitstrahl erscheinen
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("visible");
        }
      });
    }, {threshold: 0.3 });

    document.querySelectorAll(".event").forEach(event => {
      observer.observe(event);
    });

    
    // =========================
    // FORMULARE ANMELDUNGEN
    // =========================
    const notification = document.getElementById("notification");

    // =========================
    // POLTERABEND
    // =========================
    const scriptURLPolterabend = "https://script.google.com/macros/s/AKfycbxy6wG3-Wyb27Arg1f5BR0uOrGgjuHhU0pkiiwDaTMQJMIVz7YvFKclwxnedEDwg0cIgw/exec";

    const openPolterabendBtn = document.getElementById("openPolterabendBtn");
      const overlay = document.getElementById("overlay");
      const closePolterabendBtn = document.getElementById("closeformPolBtn");
      const popupPolterabend = document.getElementById("popupPolterabend");
      const formPolterabend = document.getElementById("formPolterabend");
      const teilnahmeCheckbox = document.getElementById("teilnahmePol");
      const teilnahmeSection = document.getElementById("TeilnahmePol");
      const begleitungCheckbox = document.getElementById("begleitungPol");
      const begleiterSection = document.getElementById("BegleiterPol");
      const anzahlInput = document.getElementById("anzahlBegleiterPol");
      const container = document.getElementById("begleiterFelder");
      const mitbringenCheckbox = document.getElementById("mitbringen");
      const mitbringenSection = document.getElementById("MitbringenSection");
      
      // Formular Polterabend öffnen/schließen
      openPolterabendBtn.addEventListener("click", () => {
        overlay.style.display = "block"; 
      });
      
      closePolterabendBtn.addEventListener("click", () => {
        overlay.style.display = "none";
      });
    
      // --- Anzeige der Teilnahme-Section steuern ---
      teilnahmeCheckbox.addEventListener("change", function() {
        teilnahmeSection.style.display = this.checked ? "block" : "none";
      });
    
      // =========================
      // Checkbox „Begleitung“ steuert Anzeige
      // =========================
      begleitungCheckbox.addEventListener("change", function() {
        begleiterSection.style.display = this.checked ? "block" : "none";
        if (!this.checked) {
          container.innerHTML = "";
        } else {
          generateFields();
        }
      });

      // --- Anzeige der Mitbringen-Section steuern ---
      mitbringenCheckbox.addEventListener("change", function() {
        mitbringenSection.style.display = this.checked ? "block" : "none";
      });
      
      // =========================
      // Dynamisch Begleitfelder erzeugen
      // =========================
      anzahlInput.addEventListener("input", generateFields);
      
      function generateFields() {
        container.innerHTML = "";
        const anzahl = parseInt(anzahlInput.value) || 0;
      
        for (let i = 1; i <= anzahl; i++) {
          container.innerHTML += `
            <div class="field">
              <label>Begleiter ${i} Vorname:
                <input type="text" name="begleiterVorname${i}">
              </label>
            </div>
            <div class="field">
              <label>Begleiter ${i} Nachname:
                <input type="text" name="begleiterNachname${i}">
              </label>
            </div>
            <div class="field">
              <label>Gewohnheit ${i}:
                <input type="text" name="begleitergewohnheit${i}">
              </label>
            </div>
            <div class="field">
              <span>Begleiter ${i} Alter:</span><br>
              <label><input type="radio" name="begleiterAlter${i}" value="Baby"> 0–3 Jahre</label>
              <label><input type="radio" name="begleiterAlter${i}" value="Kind"> 4–12 Jahre</label>
              <label><input type="radio" name="begleiterAlter${i}" value="Jugendlich"> älter als 12</label>
            </div>
            <hr>`;
        }
      }
      
      // =========================
      // Formular absenden
      // =========================
      formPolterabend.addEventListener("submit", async (e) => {
        e.preventDefault();
        const vorname = document.getElementById("vornamePol")?.value || "";
        const nachname = document.getElementById("nachnamePol")?.value || "";
        const teilnahme = document.getElementById("teilnahmePol")?.checked ? "Ja" : "Nein"; // ✅ korrigiert
        const gewohnheit = document.getElementById("gewohnheitPol")?.value || "";
        const Begleitung = begleitungCheckbox.checked ? "Ja" : "Nein";
        const AnzahlBegleiter = anzahlInput.value || "";
        const Uebernachtung = document.querySelector('input[name="UebernachtungPol"]:checked')?.value || "";
        const Kommentar = document.getElementById("kommentarPol")?.value || "";
        // ✅ Neues Array "Begleiter" erzeugen
        const Begleiter = [];
        if (Begleitung === "Ja") {
          const anzahl = parseInt(AnzahlBegleiter) || 0;
      
          for (let i = 1; i <= anzahl; i++) {
            const vornameB = document.querySelector(`input[name="begleiterVorname${i}"]`)?.value || "";
            const nachnameB = document.querySelector(`input[name="begleiterNachname${i}"]`)?.value || "";
            const gewohnheitB = document.querySelector(`input[name="begleitergewohnheit${i}"]`)?.value || "";
            const alterB = document.querySelector(`input[name="begleiterAlter${i}"]:checked`)?.value || "";
      
            Begleiter.push({
              Vorname: vornameB,
              Nachname: nachnameB,
              Gewohnheit: gewohnheitB,
              Alter: alterB
            });
          }
        }
        // --- Buffet-Auswahl sammeln ---
        const Buffetmitbringen = [];
        document.querySelectorAll('input[name="Buffet"]:checked').forEach(cb => {
          Buffetmitbringen.push(cb.value);
        });
        const weitereGerichte = document.getElementById("Weiteres")?.value || "";
        try {
          await fetch(scriptURLPolterabend, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              vorname,
              nachname,
              teilnahme,
              gewohnheit,
              Begleitung,
              AnzahlBegleiter,
              Uebernachtung,
              Kommentar,
              Begleiter,
              Buffetmitbringen,
              weitereGerichte
            }),
          });
      
          popupPolterabend.style.display = "none";
          notification.style.display = "block";
          setTimeout(() => {
            notification.style.display = "none";
            overlay.style.display = "none";
            formPolterabend.reset();
            container.innerHTML = ""; // Felder nach dem Reset löschen
          }, 3000);
        } catch (error) {
          alert("Fehler beim Senden: " + error);
        }
      });
      
      // =========================
      // Klick außerhalb des Popups schließt es
      // =========================
      window.addEventListener("click", (e) => {
        if (
          popupPolterabend.style.display === "block" &&
          !popupPolterabend.contains(e.target) &&
          e.target !== openPolterabendBtn
        ) {
          popupPolterabend.style.display = "none";
        }
      });

    
    // =========================
    // Hochzeit
    // =========================
    const scriptURLHochzeit = "https://script.google.com/macros/s/AKfycbx3h2rCI6mfJL7RBFHa2auPNvNhvOQFXG287V30FL8SlnTBNY17arxjfYlkLGjsjWcq1Q/exec";
    const openHochzeitBtn = document.getElementById("openHochzeitBtn");
    const overlayHoch = document.getElementById("overlayHoch");
    const closeHochzeitBtn = document.getElementById("closeformHochBtn");
    const popupHochzeit = document.getElementById("popupHochzeit");
    const formHochzeit = document.getElementById("formHochzeit");
    const teilnahmeCheckboxHoch = document.getElementById("teilnahmeHoch");
    const teilnahmeSectionHoch = document.getElementById("InformationenHoch");
    const begleitungCheckboxHoch = document.getElementById("begleitungHoch");
    const begleiterSectionHoch = document.getElementById("BegleiterHoch");
    const zimmerCheckbox = document.querySelectorAll('input[name="UebernachtungHoch"]');
    const zimmerSection = document.getElementById("Zimmer");
    const anzahlInputHoch = document.getElementById("anzahlBegleiterHoch");
    const containerHoch = document.getElementById("begleiterFelderHoch");

    //Formular Hochzeit öffnen
    openHochzeitBtn.addEventListener("click", () => {
      overlayHoch.style.display = "block";
    });

    //Formular Hochzeit schließen
    closeHochzeitBtn.addEventListener("click", () => {
      overlayHoch.style.display = "none";
    });
    
    // --- Anzeige der Teilnahme-Section steuern ---
    teilnahmeCheckboxHoch.addEventListener("change", function() {
      teilnahmeSectionHoch.style.display = this.checked ? "block" : "none";
    });
    

    // Checkbox „Begleitung“ steuert Anzeige
    begleitungCheckboxHoch.addEventListener("change", function() {
      begleiterSectionHoch.style.display = this.checked ? "block" : "none";
      if (!this.checked) {
        containerHoch.innerHTML = "";
      } else {
        generateFieldsHoch();
      }
    });

    // --- Anzeige der Zimmeranzahl steuern ---
    zimmerCheckbox.forEach(radio => {
      radio.addEventListener('change', () => {
        if (zimmerCheckbox.value = "Location" && radio.checked) {
          zimmerSection.style.display = "block";
        } else {
          zimmerSection.style.display = "none";
        }
      });
    });

    // Dynamisch Begleitfelder erzeugen
    anzahlInputHoch.addEventListener("input", generateFieldsHoch);
      
    function generateFieldsHoch() {
      containerHoch.innerHTML = "";
      const anzahlHoch = parseInt(anzahlInputHoch.value) || 0;
      for (let i = 1; i <= anzahlHoch; i++) {
        containerHoch.innerHTML += `
          <div class="field">
            <label>Begleiter ${i} Vorname:
              <input type="text" name="begleiterVornameHoch${i}">
            </label>
          </div>
          <div class="field">
            <label>Begleiter ${i} Nachname:
              <input type="text" name="begleiterNachnameHoch${i}">
            </label>
          </div>
          <div class="field">
            <label>Gewohnheit ${i}:
              <input type="text" name="begleitergewohnheitHoch${i}">
            </label>
          </div>
          <div class="field">
            <span>Begleiter ${i} Alter:</span><br>
            <label><input type="radio" name="begleiterAlterHoch${i}" value="Baby"> 0–3 Jahre</label>
            <label><input type="radio" name="begleiterAlterHoch${i}" value="Kind"> 4–12 Jahre</label>
            <label><input type="radio" name="begleiterAlterHoch${i}" value="Jugendlich"> älter als 12</label>
          </div>
          <hr>`;
      }
    }

    
    
    // Formular absenden
    formHochzeit.addEventListener("submit", async (e) => {
      e.preventDefault();
      const vorname = document.getElementById("vornameHoch")?.value || "";
      const nachname = document.getElementById("nachnameHoch")?.value || "";
      const teilnahme = document.getElementById("teilnahmeHoch")?.checked ? "Ja" : "Nein";
      const gewohnheit = document.getElementById("gewohnheitHoch")?.value || "";
      const Begleitung = begleitungCheckboxHoch.checked ? "Ja" : "Nein";
      const AnzahlBegleiter = anzahlInputHoch.value || "";
      const Uebernachtung = document.querySelector('input[name="UebernachtungHoch"]:checked')?.value || "";
      const Zimmer = document.getElementById("anzahlZimmer")?.value || "";
      const Kommentar = document.getElementById("kommentarHoch")?.value || "";
      // Neues Array "Begleiter" erzeugen
      const BegleiterHoch = [];
      if (Begleitung === "Ja") {
          const anzahlHoch = parseInt(AnzahlBegleiter) || 0;
      
          for (let i = 1; i <= anzahlHoch; i++) {
            const vornameC = document.querySelector(`input[name="begleiterVornameHoch${i}"]`)?.value || "";
            const nachnameC = document.querySelector(`input[name="begleiterNachnameHoch${i}"]`)?.value || "";
            const gewohnheitC = document.querySelector(`input[name="begleitergewohnheitHoch${i}"]`)?.value || "";
            const alterC = document.querySelector(`input[name="begleiterAlterHoch${i}"]:checked`)?.value || "";
      
            BegleiterHoch.push({
              Vorname: vornameC,
              Nachname: nachnameC,
              Gewohnheit: gewohnheitC,
              Alter: alterC
            });
          }
        }

      try {
        await fetch(scriptURLHochzeit, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ 
            vorname, 
            nachname, 
            teilnahme,
            gewohnheit,
            Begleitung,
            AnzahlBegleiter,
            Uebernachtung,
            Zimmer,
            Kommentar,
            BegleiterHoch }),
        });

        popupHochzeit.style.display ="none";
        notification.style.display = "block";
        setTimeout(() => {
          notification.style.display = "none";
          overlay.style.display ="none";
          formHochzeit.reset();
          container.innerHTML = ""; //Felder nach dem Reset löschen
        }, 3000);
      } catch (error) {
        alert("Fehler beim Senden: " + error);
      }
    });
    
    // Klick außerhalb des Popups schließt es
    window.addEventListener("click", (e) => {
      if (popupHochzeit.style.display === "block" &&
            !popupHochzeit.contains(e.target) &&
            e.target !== openHochzeitBtn) {
        popupHochzeit.style.display ="none";
      }
    });
    
  </script>
</body>
</html>
